<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holista QMS - Installation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #0d1b3e 0%, #054a91 100%); height: 100vh; display: flex; align-items: center; justify-content: center; color: #333; }
        .install-card { background: white; padding: 40px; border-radius: 15px; width: 500px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .btn-install { background: #0d1b3e; color: white; width: 100%; padding: 12px; font-weight: bold; }
        .btn-install:hover { background: #3e98fc; }
    </style>
</head>
<body>
    <div class="install-card">
        <h3 class="text-center mb-4 fw-bold" style="color: #0d1b3e;">Holista QMS Installer</h3>
        <p class="text-center text-muted mb-4">Connect to your Database & Create Admin</p>
        
        <form onsubmit="event.preventDefault(); install();">
            <h6 class="border-bottom pb-2 mb-3 text-primary">Database Configuration</h6>
            <div class="mb-3"><input type="text" id="dbHost" class="form-control" placeholder="DB Host (e.g. sdb-m.hosting.stackcp.net)" required></div>
            <div class="mb-3"><input type="text" id="dbUser" class="form-control" placeholder="DB Username (e.g. ciri)" required></div>
            <div class="mb-3"><input type="password" id="dbPass" class="form-control" placeholder="DB Password" required></div>
            <div class="mb-3"><input type="text" id="dbName" class="form-control" placeholder="DB Name (e.g. cirilla-3139359946)" required></div>

            <h6 class="border-bottom pb-2 mb-3 mt-4 text-primary">Admin Account Setup</h6>
            <div class="mb-3"><input type="email" id="adminEmail" class="form-control" placeholder="Admin Email / Username" required></div>
            <div class="mb-3"><input type="password" id="adminPass" class="form-control" placeholder="Admin Password" required></div>

            <button class="btn btn-install mt-3">Install System</button>
        </form>
    </div>

    <script>
        async function install() {
            const data = {
                dbHost: document.getElementById('dbHost').value,
                dbUser: document.getElementById('dbUser').value,
                dbPass: document.getElementById('dbPass').value,
                dbName: document.getElementById('dbName').value,
                adminEmail: document.getElementById('adminEmail').value,
                adminPass: document.getElementById('adminPass').value
            };

            const btn = document.querySelector('.btn-install');
            btn.innerText = "Installing..."; btn.disabled = true;

            try {
                const res = await fetch('/api/install', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await res.json();
                if (result.success) {
                    alert('Installation Successful!');
                    window.location.href = 'index.html';
                } else {
                    alert('Error: ' + result.error);
                    btn.innerText = "Install System"; btn.disabled = false;
                }
            } catch (e) {
                alert('Connection Error');
                btn.innerText = "Install System"; btn.disabled = false;
            }
        }
    </script>
</body>
</html>